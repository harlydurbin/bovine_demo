---
title: "PCA"
author: "Harly Durbin"
output:
  html_document:
    df_print: paged
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(readr)
library(magrittr)
library(purrr)
library(dplyr)
library(stringr)
library(ggplot2)

source(here::here("source_functions/plot_pca.R"))
```

# Notes & questions

* [Eigensoft population lists vs. projection](https://compvar-workshop.readthedocs.io/en/latest/contents/02_pca/pca.html#population-lists-vs-projection)

# Setup

```{r}
sample_metadata <- 
  read_csv(here::here("data/derived_data/metadata/bovine_demo.sample_metadata.csv")) %>% 
  mutate(international_id = if_else(international_id == "CPC98_Bprimigenius_EnglandDerbyshire_5936", "ancient_derbyshire", international_id))
```


# Results

## `full`

```{r}
plot_pca(dataset_thinning = "full.superthin", pc1 = 1, pc2 = 2, color_var = region, shape_var = species)
```


## `20cattle`

> Aurochs projected

```{r}
plot_pca(dataset_thinning = "project20cattle.superthin", pc1 = 1, pc2 = 2, color_var = continent, shape_var = species)
```

```{r}
read_vec(dataset_thinning = "project20cattle.superthin") %>% 
  View()
```

> Aurochs not projected

```{r}
plot_pca(dataset_thinning = "20cattle.superthin", pc1 = 1, pc2 = 2, color_var = region, shape_var = species)
```

## `20all`

> Aurochs projected

```{r}
plot_pca(dataset_thinning = "project20all.superthin", pc1 = 1, pc2 = 2, color_var = species)
```


> Aurochs not projected

```{r}
plot_pca(dataset_thinning = "20all.superthin", pc1 = 1, pc2 = 2, color_var = region, shape_var = species)
```


# Commentary